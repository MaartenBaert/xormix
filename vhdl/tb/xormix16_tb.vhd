-- Copyright (c) 2020-2021 Maarten Baert <info@maartenbaert.be>
-- Available under the MIT License - see LICENSE.txt for details.

-- This file was generated by `generate_vhdl.py`.

library ieee;
use ieee.std_logic_1164.all;

entity xormix16_tb is
end xormix16_tb;

architecture bhv of xormix16_tb is
    
    -- configuration
    constant streams : integer := 4;
    constant results : integer := 100;
    constant seed_x  : std_logic_vector(15 downto 0) :=
        X"2138";
    constant seed_y  : std_logic_vector(16 * streams - 1 downto 0) :=
        X"626e6b2fc22539a4";
    
    -- reference result
    type result_array_t is array(0 to results - 1) of std_logic_vector(16 * streams - 1 downto 0);
    signal ref_result : result_array_t := (
        X"626e6b2fc22539a4",
        X"c5dd4a17cf8c11a4",
        X"13efd11600b3eba4",
        X"72de7ddf43585969",
        X"e9d5bc8a8a52d1c8",
        X"4780b20e2d3a161e",
        X"714770aeac1cd90a",
        X"22421712e4ca5b7d",
        X"8ae28b30f53cfc30",
        X"c256c9f89ce257e3",
        X"3c913a3dc62fdb78",
        X"68078bfc26d788ab",
        X"fb1682d98d81ba03",
        X"a8afc4e18fdc4aa0",
        X"026d3be207e6a1a7",
        X"c3ac822cc513ed95",
        X"b5d5fba4f699f9d5",
        X"707927e3ff3cf1bd",
        X"98df7c103f5513b7",
        X"5950529b5161bfa0",
        X"b0b7e72e74776d2b",
        X"41d32c1a2cb8c854",
        X"495c2708f2721d2d",
        X"e0d6e2cca22f97c2",
        X"56a02447e600be10",
        X"59db631d4ef77878",
        X"5cd95bad69690c18",
        X"780048308c01c99b",
        X"ad6f89579929008a",
        X"673ee3f31a38b626",
        X"df9d11d80cfdcb75",
        X"24f44b9af314e9db",
        X"81345ec1c92de063",
        X"92ee7365b5179cea",
        X"0ea17942c5cc1eec",
        X"e3e86ffc1f31d3f2",
        X"2012dfa0c56867d6",
        X"fee9116710164202",
        X"f87b6931a33dbed0",
        X"abf0101b9e7d86b9",
        X"fd72cf1d40e90784",
        X"aef6680aade08d5b",
        X"04aab013982a2162",
        X"939eaddb42b0e734",
        X"b2c88f7aa9e1acb2",
        X"632eda2df46b0283",
        X"faaa3ad0f216393f",
        X"031e0bdf738986e8",
        X"dc7b221e92126902",
        X"53e398fdcf4e6b65",
        X"67c35f10d1cf5d69",
        X"9a12e3e7c0d55328",
        X"5a80b6d83aa59eb3",
        X"60ad0ae6268c6770",
        X"ba87f9e2915ae5bc",
        X"6c8979fc38e98694",
        X"9421941652a6cda8",
        X"b2a8b3dece3b8763",
        X"97d03d7c8bafde2f",
        X"26d4bfb45dbd0e11",
        X"db7f246485364308",
        X"d1985df738869340",
        X"ac44d9ca18d27668",
        X"f76598b684af4ea0",
        X"0a79d71746373130",
        X"4072efc44d26cf41",
        X"8d554b5ed6417913",
        X"f57fa2e929b614bf",
        X"371c0fac025f173b",
        X"2b4632ff3f69beb7",
        X"d26ccc4b235aedad",
        X"852893447f9f3b2a",
        X"04eb3fa55e5971ca",
        X"bbf6b6592a1e2915",
        X"e0f3ba869d6bc81d",
        X"c77cee334701a5b0",
        X"06148e3811ecf7c4",
        X"7f15cf94b1038588",
        X"83762e241835a71c",
        X"af743b077750ed4d",
        X"49d9a508e2831108",
        X"b6b37b0703447cfb",
        X"5ac183a1f96fd60d",
        X"22c0cfa8f7a7fca4",
        X"5aa8e982de642475",
        X"665bfbe1e093a90f",
        X"42db83f4301cac14",
        X"14c7d7b01497703a",
        X"f32948be79a25ce3",
        X"787d3c46ccb54e13",
        X"cb47331efc673fe9",
        X"df06bd68d9236b99",
        X"f507397b8b09ca32",
        X"cebef9993e6d35f5",
        X"65a54f1b9237edf8",
        X"28f33f0e79aa694c",
        X"1121365c556024aa",
        X"af2e6db99985923a",
        X"444cd0d9c9d9473f",
        X"2110f183c694a1cf"
    );
    
    -- DUT signals
    signal clk    : std_logic := '0';
    signal reset  : std_logic;
    signal enable : std_logic;
    signal result : std_logic_vector(16 * streams - 1 downto 0);
    
    -- flag to stop simulation
    signal run : boolean := true;
    
begin
    
    -- DUT
    inst_xormix : entity work.xormix16 generic map(
        streams => streams
    ) port map (
        clk    => clk,
        reset  => reset,
        seed_x => seed_x,
        seed_y => seed_y,
        enable => enable,
        result => result
    );
    
    -- clock process
    process
    begin
        while run loop
            clk <= '1';
            wait for 5 ns;
            clk <= '0';
            wait for 5 ns;
        end loop;
        wait;
    end process;
    
    -- input/output process
    process
    begin
        wait until rising_edge(clk);
        reset <= '1';
        enable <= '0';
        wait until rising_edge(clk);
        reset <= '0';
        enable <= '1';
        for i in 0 to results - 1 loop
            wait until rising_edge(clk);
            assert result = ref_result(i) report "Incorrect result" severity warning;
        end loop;
        run <= false;
        wait;
    end process;
    
end bhv;

