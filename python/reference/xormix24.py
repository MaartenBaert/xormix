# Copyright (c) 2020-2021 Maarten Baert <info@maartenbaert.be>
# Available under the MIT License - see LICENSE.txt for details.

import xormix

matrix = [
	[ 5,  4, 18, 11, 14],
	[12, 16, 22, 17, 19,  2],
	[ 0, 21,  9, 18, 13],
	[ 1, 11, 23,  9,  3, 16],
	[12,  8,  4, 11,  3],
	[10,  9, 13, 19,  4,  8],
	[ 8,  2, 13, 11, 20],
	[16,  5, 10, 17, 14, 23],
	[23, 22, 20, 15, 16],
	[ 0, 20, 11, 22,  9, 15],
	[ 3, 22,  5, 12,  4],
	[23,  6,  7, 10, 21, 20],
	[ 6, 10,  9, 15,  2],
	[20,  8,  4, 10, 21, 15],
	[18, 22, 15, 13, 19],
	[15, 17, 13,  3,  7,  1],
	[ 9,  6,  1,  0,  7],
	[ 1, 14, 18, 17,  5,  7],
	[10, 18,  0, 16, 21],
	[11, 19, 23, 21,  3, 17],
	[ 8,  7,  1, 16,  6],
	[ 8,  0, 22, 21, 16,  5],
	[14,  6, 17,  2,  4],
	[12,  2, 14, 19,  0,  1],
]

salts = [
	0xd96a94, 0x8c3c8d, 0xb8b710, 0x112b89,
	0x6aaf55, 0x295e05, 0xa64b72, 0x39b1db,
	0x5c5955, 0x915302, 0x040da6, 0xe79f3f,
	0xf52624, 0xce7aee, 0x74c90b, 0x00c73d,
	0x1cee53, 0xeb76b1, 0x271093, 0x73ac8e,
	0x57622b, 0xbf29d0, 0x02efea, 0xa1befc,
]

shuffle = [
	 0,  7, 17,  8,  9, 13, 11, 12,  2, 16, 14,  4, 21, 10,  3, 20,
	22, 19, 15,  1,  5, 23,  6, 18,
]

shifts = [8, 12, 9, 11]

def next_state(state):
	return xormix.next_state(matrix, salts, shuffle, shifts, state)
