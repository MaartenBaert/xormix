# Copyright (c) 2020-2021 Maarten Baert <info@maartenbaert.be>
# Available under the MIT License - see LICENSE.txt for details.

import xormix

matrix = [
	[23, 55, 16, 37, 36],
	[27, 52,  1, 58, 32, 23],
	[ 2,  1, 22, 17, 43],
	[45, 42, 32, 63, 59, 23],
	[ 7, 29, 47, 31, 38],
	[12, 44, 51, 28, 18, 14],
	[62, 56, 29, 42,  3],
	[ 9, 37, 63, 59, 52, 38],
	[57, 36, 25, 27, 55],
	[34, 59, 40,  6, 48, 52],
	[13, 30, 56, 41, 33],
	[21, 31, 12, 30, 57, 18],
	[16, 34, 35, 47, 18],
	[35, 20,  3, 49, 14, 38],
	[ 4, 37,  6,  2, 41],
	[51, 14, 10, 56, 19, 23],
	[42, 11, 56,  3,  6],
	[54, 50, 12, 45, 53, 36],
	[10, 50, 42, 22, 61],
	[ 9, 49, 41, 24,  8, 45],
	[ 6, 32,  2, 19, 44],
	[41, 13, 60, 40, 35, 53],
	[40, 14, 19, 13, 41],
	[42, 61, 25, 30, 58, 63],
	[ 1, 40, 10, 15, 24],
	[20, 12, 50, 32, 23, 15],
	[22, 47, 35, 37,  0],
	[17, 36,  6, 16,  0, 58],
	[21, 39, 12,  7, 29],
	[46, 28,  2, 33,  6, 13],
	[44, 24, 31, 51, 30],
	[51, 28, 50, 16, 20,  8],
	[33, 44, 42, 45,  7],
	[31, 21, 48, 22, 33, 46],
	[50, 58, 59, 26, 53],
	[ 5, 44, 15,  7, 32, 49],
	[36, 26, 46, 27, 55],
	[37, 34, 27, 22, 62, 13],
	[49, 26, 60, 63, 23],
	[ 9, 25, 16,  5, 60, 46],
	[47, 53, 54, 15, 29],
	[11, 15, 28,  4,  0, 56],
	[43, 31,  8, 54, 26],
	[34, 25, 47, 19, 30, 14],
	[58, 21, 41, 26, 25],
	[ 4, 48, 41, 35,  8, 31],
	[55, 20, 16, 40, 26],
	[61, 24,  8,  1, 29,  9],
	[ 7, 33, 62, 53, 39],
	[43, 17, 38, 11, 40, 23],
	[57, 21,  0, 11, 39],
	[27,  5, 61, 13, 10, 18],
	[48, 10, 62,  4, 11],
	[54, 17, 63,  4, 61, 22],
	[ 2, 57, 39, 17,  3],
	[ 0,  2, 52, 63,  1, 40],
	[ 2, 19, 39, 29,  9],
	[31, 20, 18, 62, 57,  3],
	[45, 43, 51, 55, 16],
	[52,  1, 14,  7, 49, 30],
	[52, 37,  7, 21, 25],
	[49, 34, 57, 42, 46, 60],
	[48, 32,  5, 50, 43],
	[63, 20, 28, 27, 38, 60],
]

salts = [
	0x6c1f4cf86b670928, 0x254b7cacdf1f7f73, 0x9384f7a0b1b8600e, 0x6402b3d837dfb664,
	0x7cb8aabfdc88b651, 0xb89b5f5e1de22367, 0x5def7160d6d4e4b9, 0x8d2ef95b68e2110b,
	0xffc0742fc5f3dbe3, 0x87ce80324751b6e0, 0x147610fcd384ae2a, 0xbb625e1c429581e7,
	0x42c3fc05de25f0c0, 0xdb6752d26b3e7d9a, 0x3edd68a5eb6ba2b1, 0x63600f8ae4c7a36a,
	0xa8b436b35f0594b6, 0xe7740ee396e0303c, 0x4711b906c747cf69, 0x2bd0973542881c68,
	0x9819f173380f1778, 0x05fa834a446f5780, 0x3aca5c28507a9812, 0x3f8fae1df7b5284f,
	0x0fca61766c25a956, 0x344a280b81b3dc59, 0x9ae49767ed2aac9d, 0x136354a988e7dc44,
	0xa47463136a589763, 0xcca5d6d4ad8ff5e6, 0x3e2a049598688d41, 0xd79394eb53e8e614,
	0x3bebfb323f75041e, 0x635aa20bf255c061, 0x6026a67855446ab6, 0x6f801ac1a01937d3,
	0x282dcf755931c792, 0x42a866fb536b5c24, 0xfc666ffe8b3ee689, 0xa2e9693598d4d120,
	0x68d7594964f92460, 0xadbcae73ac34dd49, 0x993e260d3c6f44bc, 0x5c72e28f77c7ab3d,
	0x6863f70a8cc13391, 0xb3bc2c1931d5afe6, 0x590494397519cd48, 0x77ecc3481691cd65,
	0x1388ee338164ea29, 0x2ff27333a309bbbc, 0xeaebc14b790da4b9, 0x61c2af10615a09fb,
	0xa35d4d739948bace, 0xdda19468d60247e6, 0xcf1f611a8269bc91, 0x0adeb7af980adf73,
	0x14eccb6a88a0129e, 0x71aaacdba83328de, 0x135e1971c5db62b7, 0xc5041c150065d8fd,
	0x42a68068988aff0c, 0xf811709d805968db, 0xe3bd59c3b7844bc4, 0xe9602cb6280a6c70,
]

shuffle = [
	39, 11, 51, 53, 61, 31, 29, 27, 12, 57, 43, 56, 42,  2, 26, 37,
	41, 10, 20, 44,  7, 28, 13,  9, 25, 32, 52, 14, 19, 60, 48, 49,
	 5, 36,  0,  3, 58, 22, 35, 21, 16, 30, 34, 63,  8, 17, 24, 54,
	18, 50, 45,  6, 46, 33, 23, 62, 15, 59, 55, 38, 40,  1,  4, 47,
]

shifts = [28, 31, 24, 30]

def next_state(state):
	return xormix.next_state(matrix, salts, shuffle, shifts, state)
