# Copyright (c) 2020-2021 Maarten Baert <info@maartenbaert.be>
# Available under the MIT License - see LICENSE.txt for details.

import xormix

matrix = [
	[56, 40, 59,  0, 27],
	[49, 48,  4, 39, 10, 31],
	[15, 35, 32,  7, 23],
	[14,  3, 37, 49, 28, 61],
	[48, 18, 59, 29, 25],
	[ 1, 44, 18, 19,  6,  2],
	[41, 39, 15, 14, 33],
	[59, 40, 32, 27, 63, 50],
	[10, 37, 17,  8, 21],
	[47, 30, 11, 25, 16, 58],
	[36, 60, 58, 23, 25],
	[47, 21, 46,  5, 29, 32],
	[ 7, 63, 44, 19, 60],
	[22, 52, 49, 18, 15,  3],
	[32, 46,  5,  6, 31],
	[42, 33, 16,  1, 21,  6],
	[34, 11, 18, 55, 12],
	[41, 43, 10, 47, 57, 28],
	[31, 38, 13, 32, 48],
	[ 8,  9, 36, 62,  1, 42],
	[45,  3, 57,  4, 59],
	[34, 27, 48, 39, 41, 12],
	[40, 17, 36, 54, 62],
	[13,  9, 45, 25, 28, 42],
	[21, 17, 54, 60,  0],
	[ 8, 48, 47, 40,  4, 19],
	[22, 25, 42, 37, 32],
	[ 6, 38, 26, 50, 49, 41],
	[26, 51, 62, 24, 15],
	[31,  6, 54, 56, 58, 29],
	[20, 63,  2, 22,  9],
	[ 5, 14, 42, 56, 12, 15],
	[ 8, 20, 51, 12, 53],
	[52, 43,  0, 11, 46, 23],
	[12, 20, 38, 16, 44],
	[28,  3, 59, 53, 38, 21],
	[10, 56, 30, 57, 38],
	[47, 50,  6, 54,  4, 49],
	[22, 36,  7, 45, 37],
	[46, 21, 26, 55, 58, 35],
	[14, 26, 34, 33, 17],
	[43, 50, 55, 58,  2,  1],
	[55, 57, 33, 49, 51],
	[47, 26, 22,  0, 35, 10],
	[30, 39, 56, 57,  7],
	[53, 24, 52, 12, 44, 36],
	[ 5, 58, 52,  9, 20],
	[ 7, 16, 62, 42, 53, 38],
	[19, 28,  4, 27, 13],
	[26, 46, 20, 27, 17, 29],
	[28, 40, 14,  4, 63],
	[ 2, 24, 61,  1,  5, 56],
	[45, 23, 44, 18, 39],
	[45, 40, 29, 61,  0, 33],
	[ 7, 50,  5, 62, 13],
	[13, 14, 61, 17, 63, 18],
	[27, 34,  9, 24, 11],
	[ 0, 19, 23,  7, 59, 25],
	[51,  4, 30, 46, 61],
	[11, 54, 52, 24, 60, 35],
	[30, 55, 53, 16, 31],
	[ 3, 33, 36, 58,  8, 45],
	[37, 41, 62, 34, 35],
	[63, 39, 22, 55, 43, 42],
]

salts = [
	0x6c1f4cf86b670928, 0x254b7cacdf1f7f73, 0x9384f7a0b1b8600e, 0x6402b3d837dfb664,
	0x7cb8aabfdc88b651, 0xb89b5f5e1de22367, 0x5def7160d6d4e4b9, 0x8d2ef95b68e2110b,
	0xffc0742fc5f3dbe3, 0x87ce80324751b6e0, 0x147610fcd384ae2a, 0xbb625e1c429581e7,
	0x42c3fc05de25f0c0, 0xdb6752d26b3e7d9a, 0x3edd68a5eb6ba2b1, 0x63600f8ae4c7a36a,
	0xa8b436b35f0594b6, 0xe7740ee396e0303c, 0x4711b906c747cf69, 0x2bd0973542881c68,
	0x9819f173380f1778, 0x05fa834a446f5780, 0x3aca5c28507a9812, 0x3f8fae1df7b5284f,
	0x0fca61766c25a956, 0x344a280b81b3dc59, 0x9ae49767ed2aac9d, 0x136354a988e7dc44,
	0xa47463136a589763, 0xcca5d6d4ad8ff5e6, 0x3e2a049598688d41, 0xd79394eb53e8e614,
	0x3bebfb323f75041e, 0x635aa20bf255c061, 0x6026a67855446ab6, 0x6f801ac1a01937d3,
	0x282dcf755931c792, 0x42a866fb536b5c24, 0xfc666ffe8b3ee689, 0xa2e9693598d4d120,
	0x68d7594964f92460, 0xadbcae73ac34dd49, 0x993e260d3c6f44bc, 0x5c72e28f77c7ab3d,
	0x6863f70a8cc13391, 0xb3bc2c1931d5afe6, 0x590494397519cd48, 0x77ecc3481691cd65,
	0x1388ee338164ea29, 0x2ff27333a309bbbc, 0xeaebc14b790da4b9, 0x61c2af10615a09fb,
	0xa35d4d739948bace, 0xdda19468d60247e6, 0xcf1f611a8269bc91, 0x0adeb7af980adf73,
	0x14eccb6a88a0129e, 0x71aaacdba83328de, 0x135e1971c5db62b7, 0xc5041c150065d8fd,
	0x42a68068988aff0c, 0xf811709d805968db, 0xe3bd59c3b7844bc4, 0xe9602cb6280a6c70,
]

shuffle = [
	39, 11, 51, 53, 61, 31, 29, 27, 12, 57, 43, 56, 42,  2, 26, 37,
	41, 10, 20, 44,  7, 28, 13,  9, 25, 32, 52, 14, 19, 60, 48, 49,
	 5, 36,  0,  3, 58, 22, 35, 21, 16, 30, 34, 63,  8, 17, 24, 54,
	18, 50, 45,  6, 46, 33, 23, 62, 15, 59, 55, 38, 40,  1,  4, 47,
]

shifts = [28, 31, 24, 30]

def next_state(state):
	return xormix.next_state(matrix, salts, shuffle, shifts, state)
