# Copyright (c) 2020-2021 Maarten Baert <info@maartenbaert.be>
# Available under the MIT License - see LICENSE.txt for details.

import xormix

matrix = [
	[ 0, 27, 29, 19, 26],
	[10, 14, 30, 31, 26,  9],
	[15, 18, 27,  0,  4],
	[19, 10,  7, 13,  1, 29],
	[15, 31,  3,  7, 13],
	[ 8, 31,  6, 21,  7, 28],
	[19, 14,  2, 16,  5],
	[ 2, 24,  0, 18,  9, 23],
	[ 3, 20, 21, 12, 15],
	[10,  0, 12, 20,  6,  8],
	[29,  6, 16, 10, 17],
	[12,  7, 10, 22, 25,  5],
	[ 1, 10, 22, 30, 28],
	[20, 25, 18, 13, 22, 30],
	[22, 26,  3, 28,  8],
	[25, 17, 23, 28, 24, 15],
	[ 1, 27, 26, 21, 22],
	[ 3,  8,  9,  2, 31, 22],
	[ 2, 23, 13, 12, 25],
	[26, 12,  6, 21, 15,  5],
	[ 5,  4, 19, 16, 23],
	[18, 25, 13, 26, 11, 23],
	[ 9, 29, 11, 17, 30],
	[ 4, 18, 24, 31, 25, 28],
	[11, 27,  2,  1, 30],
	[14, 24, 20, 27, 31,  3],
	[ 9, 16, 12, 29,  7],
	[ 9,  7,  8, 14,  3,  1],
	[20, 14, 29,  5, 24],
	[19, 28, 18,  0,  3, 17],
	[25, 16, 11, 13, 17],
	[ 4, 27, 11,  8, 30, 21],
]

salts = [
	0x198f8d32, 0x46d9b8ac, 0x57f90206, 0xcb246290,
	0x5fda94c2, 0xb9969e83, 0x990053fe, 0x0cef1f8b,
	0x9baafefa, 0x232b8463, 0x0fc77197, 0xd113a2d8,
	0xd6c99ef7, 0xf3fb7189, 0x9ceeb1dd, 0x352df180,
	0xfeed780c, 0xee211518, 0x3afaca18, 0x95f13c50,
	0xd8449f2a, 0x59752549, 0x854f0980, 0x234a07b4,
	0x51c0c69b, 0xa71d489e, 0x618cbc79, 0xab0e51e1,
	0x965c4507, 0xe90488a4, 0x73674eb7, 0x00af1456,
]

shuffle = [
	15, 29,  5,  0, 16,  9, 26, 14, 13, 10, 19, 11,  2,  6,  8, 17,
	20,  4, 22, 30, 31, 21, 24, 25, 18, 27, 28, 23, 12,  7,  1,  3,
]

shifts = [6, 16, 9, 15]

def next_state(state):
	return xormix.next_state(matrix, salts, shuffle, shifts, state)
