# Copyright (c) 2020-2021 Maarten Baert <info@maartenbaert.be>
# Available under the MIT License - see LICENSE.txt for details.

import xormix

matrix = [
	[18,  5, 24, 23,  2],
	[ 5, 10, 11, 28, 31,  3],
	[29, 17, 12, 24, 20],
	[26,  0, 14, 27,  9, 18],
	[ 7, 24, 15, 18, 28],
	[ 4, 22, 29,  7, 15,  6],
	[26,  8,  7, 25, 30],
	[10, 13, 31, 22,  2,  5],
	[13,  3, 22, 12, 28],
	[ 5, 17, 22,  2,  1, 24],
	[27, 14,  1, 21,  3],
	[30, 20, 22, 15, 27,  0],
	[ 0, 28, 26,  5,  9],
	[26, 21, 18, 25, 17,  6],
	[20, 28, 31, 22,  8],
	[ 7, 16, 24, 25,  9,  3],
	[26, 27,  3, 19, 20],
	[30,  9,  4, 11, 20, 14],
	[ 4, 20, 13, 19, 25],
	[ 8, 30,  0, 24, 23, 10],
	[17,  0, 16, 15, 12],
	[ 1, 19,  8, 29, 14, 28],
	[ 7, 12,  2, 23, 13],
	[ 8, 13, 14, 23,  6,  4],
	[ 4, 31, 12, 29, 11],
	[ 6,  7,  9, 11, 13, 12],
	[19, 26, 16, 25, 10],
	[11, 30,  8,  1, 19, 16],
	[19, 11, 21,  2, 18],
	[21, 20, 26, 16, 13,  1],
	[15, 21, 27,  4, 12],
	[18,  2, 29, 23,  0,  9],
]

salts = [
	0x198f8d32, 0x46d9b8ac, 0x57f90206, 0xcb246290,
	0x5fda94c2, 0xb9969e83, 0x990053fe, 0x0cef1f8b,
	0x9baafefa, 0x232b8463, 0x0fc77197, 0xd113a2d8,
	0xd6c99ef7, 0xf3fb7189, 0x9ceeb1dd, 0x352df180,
	0xfeed780c, 0xee211518, 0x3afaca18, 0x95f13c50,
	0xd8449f2a, 0x59752549, 0x854f0980, 0x234a07b4,
	0x51c0c69b, 0xa71d489e, 0x618cbc79, 0xab0e51e1,
	0x965c4507, 0xe90488a4, 0x73674eb7, 0x00af1456,
]

shuffle = [
	15, 29,  5,  0, 16,  9, 26, 14, 13, 10, 19, 11,  2,  6,  8, 17,
	20,  4, 22, 30, 31, 21, 24, 25, 18, 27, 28, 23, 12,  7,  1,  3,
]

shifts = [6, 16, 9, 15]

def next_state(state):
	return xormix.next_state(matrix, salts, shuffle, shifts, state)
