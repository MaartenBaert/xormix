Xormix python scripts
=====================

The python scripts in this folder have been divided into three subdirectories:

- The `reference` directory contains the xormix reference implementation. This implementation is very slow, but it is easy to understand and serves as the reference against which all other implementations are verified.
- The `design` directory contains several scripts that were used during the design phase to determine the best parameters for the various xormix variants, as well as some scripts that analyze the mathematical properties of xormix.
- The `codegen` directory contains the scripts that were used to generate the VHDL, Verilog and some of the C++ code.

These scripts have evolved over time together with the xormix design itself. As a result, there are weird interdependencies between these scripts, for example some of the `design` scripts import code that was generated by `codegen` scripts based on parameters from the `reference` scripts which in turn were calculated by the `design` scripts. This was hard to avoid without duplicating a lot of code. The outcome of the `design` scripts doesn't actually depend on the parameters that are already in the code though, so if you wanted to recreate xormix from scratch based on these scripts, you could just use temporary placeholder parameters to get started. All the scripts are fully deterministic, so you can re-run them to regenerate the design parameters and they should match the ones found in the reference implementation.

Most of the scripts from the `design` and `codegen` directories will import modules from the `reference` directory, so you should add this directory to the PYTHONPATH environment variable when running such scripts. Additionally, some scripts use python modules that are written in C++ for performance reasons. These are located in the `cpp/pycpp` directory and should be compiled first. After doing so, the C++ build directory should be added to the python path to load those modules. For example, in order to run the `avalanche_test.py` script from the `design` directory, you would use the following commands:

```
cp <xormix_directory>/cpp
mkdir build-release
cd build-release
cmake -DCMAKE_BUILD_TYPE=Release -DBUILD_PYTHON=ON ..
make
cd <xormix_directory>/python/design
PYTHONPATH=../reference:../../cpp/build-release python avalanche_test.py
```

Below you will find a short summary of what each of the scripts does.

Reference
---------

- `xormix_ref.py`: The xormix algorithm reference implementation. This implementation supports arbitrary word sizes.
- `xormix16.py` ... `xormix128.py`: The parameters for the various xormix variants.
- `xormix_all.py`: A convenience module that loads all the xormix variant modules and combines them in a dictionary. It also contains dictionaries of prime factors, which are hard to calculate in python.

Design
------

- `extract_lfsr.py`: Extracts the equivalent LFSR representation of the state transition matrix that describes the first stage of xormix.
- `extract_phases.py`: Extracts the phases of the LFSR sequences produced by the output bits of the first stage of xormix.
- `generate_matrix.py`: Generates state transition matrices for the first stage of xormix that meet the requirements described in `doc/design-criteria.md`.
- `avalanche_test.py`: Performs avalanche testing to determine the best parameters for the second stage of xormix. These tests are very computationally expensive and can take several days to run to completion, especially for the largest xormix variants. The avalanche testing procedure is explained in more detail in `doc/design-criteria.md`.

Codegen
-------

- `generate_vhdl.py`: Generates the VHDL implementation and testbenches of all xormix variants.
- `generate_verilog.py`: Generates the Verilog implementation and testbenches of all xormix variants.
- `generate_cpp.py`: Generates the C++ file which contains the xormix parameters.
